<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>


<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>åæ”¯ä¸€è¦§</title>
  <link rel="stylesheet" href="/stylesheets/style.css">
</head>
<body>

<!-- â–¼ ã‚µãƒãƒªãƒ¼å¸¯ -->
<div class="summary-wrapper">
  <div class="summary-item income">
    <span class="label">ç·åå…¥</span>
    <span class="value">Â¥<%= income.toLocaleString() %></span>
  </div>

  <div class="summary-item expense">
    <span class="label">ç·æ”¯å‡º</span>
    <span class="value">Â¥<%= expense.toLocaleString() %></span>
  </div>

  <div class="summary-item balance">
    <span class="label">æ®‹é«˜</span>
    <span class="value">Â¥<%= balance.toLocaleString() %></span>
  </div>

  <button class="filter-btn" onclick="toggleFilter()">ğŸ”</button>
</div>

<!-- â–¼ æ¤œç´¢ãƒ•ã‚£ãƒ«ã‚¿ -->
<div id="filterBox" class="filter-box">
  <form action="/items" method="GET">
    <label>åŒºåˆ†ï¼š</label>
    <select name="type">
      <option value="">ã™ã¹ã¦</option>
      <option value="income">åå…¥</option>
      <option value="expense">æ”¯å‡º</option>
    </select>

    <label>é–‹å§‹æ—¥ï¼š</label>
    <input type="date" name="createdAt" placeholder="æ—¥ä»˜ï¼ˆä»»æ„ï¼‰">


    <label>çµ‚äº†æ—¥ï¼š</label>
    <input type="date" name="createdAt" placeholder="æ—¥ä»˜ï¼ˆä»»æ„ï¼‰">

    <button class="search-btn">æ¤œç´¢</button>
  </form>
</div>

<div class="container">

  <!-- â–¼ è¿½åŠ ãƒ•ã‚©ãƒ¼ãƒ  -->
  <div class="input-card">
    <h2>æ–°ã—ã„åæ”¯ã‚’è¿½åŠ </h2>

   <form action="/items" method="POST">
      <input type="date" name="createdAt" placeholder="æ—¥ä»˜" required>
      <input type="text" name="event" placeholder="é …ç›®å" required>
      <input type="number" name="amount" placeholder="é‡‘é¡" required>

      <select name="type" required>
        <option value="">åŒºåˆ†ã‚’é¸æŠ</option>
        <option value="income">åå…¥</option>
        <option value="expense">æ”¯å‡º</option>
      </select>

      <textarea name="memo" placeholder="ãƒ¡ãƒ¢ï¼ˆä»»æ„ï¼‰"></textarea>

      <button class="add-btn">è¿½åŠ </button>
    </form>
  </div>


  <!-- â–¼ ä¸€è¦§è¡¨ç¤º -->
  <!-- â–¼ ä¸€è¦§è¡¨ç¤º -->
<% items.forEach(item => { %>
  <div class="item-card <%= item.type %>">
    <div class="item-row">

      <!-- å·¦å´ -->
      <div class="item-left">
        <h3 class="item-title"><%= item.event %></h3>
        <p class="amount">Â¥<%= item.amount %></p>
        <p class="type"><%= item.type === "income" ? "åå…¥" : "æ”¯å‡º" %></p>

        <% if (item.memo) { %>
          <p class="memo"><%= item.memo %></p>
        <% } %>
      </div>

      <!-- å³å´ï¼ˆãƒœã‚¿ãƒ³å«ã‚€ï¼‰ -->
      <div class="item-right">
        <p class="date"><%= item.createdAt.toLocaleDateString() %></p>

        <div class="item-actions-inline">
          <a href="/items/detail?id=<%= item.id %>" class="detail-btn">è©³ç´°</a>
          <a href="/items/edit/<%= item.id %>" class="edit-btn">ç·¨é›†</a>
          <a href="/items/delete/<%= item.id %>" class="delete-btn">å‰Šé™¤</a>
        </div>
      </div>

    </div>

  </div>
<% }) %>


</div>

<script>
  function toggleFilter() {
    document.getElementById('filterBox').classList.toggle('show');
  }

  flatpickr("input[name='createdAt']", {
    dateFormat: "Y/m/d",
    locale: "ja",
  });
</script>

</body>
</html>
